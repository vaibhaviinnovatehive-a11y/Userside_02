{% extends "base.html" %}

{% block title %}InnovateGuide - Project Innovation Partner{% endblock %}

{% block content %}
    <!-- Hero Section -->
    <section id="home" class="hero">
        <div class="container">
            <div class="hero-content">
                <h2>Project Innovation Partner</h2>
                <p>Buy, sell, and explore innovative IT projects made by students, for students.</p>

                <!-- Search Bar -->
                <form action="/search" method="GET" class="search-container">
                    <input type="text" name="q" placeholder="Search projects by technology, title, or keyword..." required>
                    <button type="submit">Search</button>
                </form>

                <div class="hero-actions">
                     <a href="/browse_all_projects" class="btn cta-button">Browse All Projects</a>
                     <a href="/sell_your_project" class="btn cta-button">Sell Your Project</a>
                 </div>
            </div>
        </div>
    </section>

    <!-- About Us -->
    <section id="about-us" class="section about-us">
        <div class="container">
            <div class="about-card">
                <h2 class="section-title">About Us</h2>
                <p class="section-subtitle">Empowering Innovation in Tech Education</p>

                <p><strong>InnovateGuide</strong> is a premier platform dedicated to buying and selling innovative tech projects. Focused on fostering <em>innovation</em>, we cater to students, developers, and professionals seeking real-world projects across diverse domains.</p>

                <p>Our marketplace encompasses cutting-edge areas including Web development, AI/ML, Software engineering, Cloud computing, and more. We provide a trusted environment where creativity thrives, enabling users to exchange knowledge, build portfolios, and drive technological advancement.</p>
            </div>
        </div>
    </section>

    <!-- Trending Projects -->
    <section id="trending-projects" class="section trending-projects">
        <div class="container">
            <h2 class="section-title">Trending Projects</h2>
            <p class="section-subtitle">These are projects that are currently getting the most views, downloads, and interest. Stay inspired by what's trending across the InnovateGuide community.</p>

            <div class="projects-carousel">
                <div class="carousel-container">
                    <div class="carousel-track">
                        {% for project in trending_projects %}
                        <div class="project-card">
                            <div class="project-image">
                                <img src="{{ project.image }}" alt="{{ project.title }}">
                            </div>
                            <div class="project-info">
                                <h3>{{ project.title }}</h3>
                                <p>{{ project.description }}</p>
                                <div class="project-tags">
                                    {% for tech in project.technology %}
                                    <span class="tag">{{ tech }}</span>
                                    {% endfor %}
                                </div>
                                <div class="project-meta">
                                    <span class="price">₹{{ project.price }}</span>
                                    <span class="difficulty {{ project.difficulty|lower }}">{{ project.difficulty }}</span>
                                </div>
                                <a href="/project/{{ project.id }}" class="btn btn-primary btn-small">View Details</a>


                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                <button class="slider-btn left">‹</button>
                <button class="slider-btn right">›</button>
            </div>
        </div>
    </section>

    <!-- Newly Added Projects -->
    <section id="new-projects" class="section new-projects">
        <div class="container">
            <h2 class="section-title">Newly Added Projects</h2>
            <p class="section-subtitle">Discover the latest IT projects uploaded by students and developers. Fresh ideas, new technologies, and innovative concepts.</p>

            <div class="projects-carousel">
                <div class="carousel-container">
                    <div class="carousel-track">
                        {% for project in new_projects %}
                        <div class="project-card">
                            <div class="project-image">
                                <img src="{{ project.image }}" alt="{{ project.title }}">
                            </div>
                            <div class="project-info">
                                <h3>{{ project.title }}</h3>
                                <p>{{ project.description }}</p>
                                <div class="project-tags">
                                    {% for tech in project.technology %}
                                    <span class="tag">{{ tech }}</span>
                                    {% endfor %}
                                </div>
                                <div class="project-meta">
                                    <span class="price">₹{{ project.price }}</span>
                                    <span class="difficulty {{ project.difficulty|lower }}">{{ project.difficulty }}</span>
                                </div>
                                <a href="/project/{{ project.id }}" class="btn btn-small new-view-btn">View Details</a>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                <button class="slider-btn left">‹</button>
                <button class="slider-btn right">›</button>
            </div>
        </div>
    </section>

    <!-- Explore Mini Projects -->
    <section id="mini" class="section mini-projects">
        <div class="container">
            <h2 class="section-title">Explore Mini Projects</h2>
            <p class="section-subtitle">Discover affordable, beginner-friendly projects to kickstart your learning journey.</p>

            <div class="projects-carousel">
                <div class="carousel-container">
                    <div class="carousel-track">
                        {% for project in mini_projects %}
                        <div class="project-card">
                            <div class="project-image">
                                <img src="{{ project.image }}" alt="{{ project.title }}">
                            </div>
                            <div class="project-info">
                                <h3>{{ project.title }}</h3>
                                <p>{{ project.description }}</p>
                                <div class="project-tags">
                                    {% for tech in project.technology %}
                                    <span class="tag">{{ tech }}</span>
                                    {% endfor %}
                                </div>
                                <div class="project-meta">
                                    <span class="price">₹{{ project.price }}</span>
                                    <span class="difficulty {{ project.difficulty|lower }}">{{ project.difficulty }}</span>
                                </div>
                                <a href="/project/{{ project.id }}" class="btn btn-small new-view-mini">View Details</a>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                <button class="slider-btn left">‹</button>
                <button class="slider-btn right">›</button>
            </div>
        </div>
    </section>

<!-- Project Categories (REPLACE ONLY THIS SECTION) -->
<section id="categories" class="section categories">
  <div class="container">
    <h2 class="section-title">Project Categories</h2>
    <p class="section-subtitle">Browse projects by technology or domain — easily find projects that match your skill level, interest, or academic needs.</p>

    <div class="categories-carousel">
      <div class="carousel-container">
        <div class="carousel-track">
          {% set name_map = {
            "Web Development": "Web Development","web development": "Web Development","Web Dev": "Web Development",
            "App Development": "App Development","Mobile App": "App Development","Mobile": "App Development",
            "Web Application": "Web Application","Web App": "Web Application",
            "Data Science": "Data Science","data science": "Data Science",
            "AIML": "AIML","Artificial Intelligence and Machine Learning": "AIML","AI/ML": "AIML","Artificial Intelligence": "AIML",
            "Blockchain": "Blockchain","blc": "Blockchain",
            "Cyber Security": "Cyber Security","Cybersecurity": "Cyber Security","Security": "Cyber Security",
            "Cloud Computing": "Cloud Computing","Cloud": "Cloud Computing"
          } %}

          {% for category in categories %}
            {% if category is mapping %}
              {% set raw_name = category.name %}
              {% set cdesc = category.description if category.description is defined else '' %}
            {% else %}
              {% set raw_name = category %}
              {% set cdesc = '' %}
            {% endif %}
            {% set raw_name = raw_name|string %}
            {% set raw_name = raw_name.strip() %}
            {% set cname = name_map[raw_name] if raw_name in name_map else raw_name %}

            <div class="category-card">
              <div class="category-icon" role="img" aria-label="{{ cname }}">
                {% if cname == "Web Development" %}
                  <img src="{{ url_for('static', filename='icons/categories/web.png') }}" alt="Web Development">
                {% elif cname == "App Development" %}
                  <img src="{{ url_for('static', filename='icons/categories/app-development.png') }}" alt="App Development">
                {% elif cname == "Web Application" %}
                  <img src="{{ url_for('static', filename='icons/categories/web_app.png') }}" alt="Web Application">
                {% elif cname == "Data Science" %}
                  <img src="{{ url_for('static', filename='icons/categories/data-science.png') }}" alt="Data Science">
                {% elif cname == "AIML" %}
                  <img src="{{ url_for('static', filename='icons/categories/aiml.png') }}" alt="AIML">
                {% elif cname == "Blockchain" %}
                  <img src="{{ url_for('static', filename='icons/categories/blockchain.png') }}" alt="Blockchain">
                {% elif cname == "Cyber Security" %}
                  <img src="{{ url_for('static', filename='icons/categories/cyber-security.png') }}" alt="Cyber Security">
                {% elif cname == "Cloud Computing" %}
                  <img src="{{ url_for('static', filename='icons/categories/cloud-computing.png') }}" alt="Cloud Computing">
                {% else %}
                  <img src="{{ url_for('static', filename='icons/categories/idea.png') }}" alt="General">
                {% endif %}
              </div>

              <div class="category-info">
                <h3>{{ cname }}</h3>
                <p>{{ cdesc if cdesc else ('Explore ' ~ cname|lower ~ ' projects') }}</p>
              </div>

              <a href="/browse_all_projects?category={{ cname|lower|replace(' ', '_') }}" class="btn btn-small category-browse-btn">Browse</a>
            </div>

          {% endfor %}
        </div>
      </div>

      <button class="category-slider-btn left">‹</button>
      <button class="category-slider-btn right">›</button>
    </div>
  </div>
</section>

<!-- Top Selling Projects -->
    <section id="top-selling" class="section top-selling-projects">
        <div class="container">
            <h2 class="section-title">Top Selling Projects</h2>
            <p class="section-subtitle">Discover the most purchased and highly rated projects that students love the most.</p>

            <div class="projects-carousel">
                <div class="carousel-container">
                    <div class="carousel-track top-selling-cards" id="topSellingContainer">
                        {% for project in top_selling_projects %}
                        <div class="project-card">
                            <div class="project-image">
                                <img src="{{ project.image }}" alt="{{ project.title }}">
                                <div class="sales-badge">{{ project.sales_count }} sold</div>
                            </div>
                            <div class="project-info">
                                <h3>{{ project.title }}</h3>
                                <p>{{ project.description }}</p>
                                <div class="project-tags">
                                    {% for tech in project.technology %}
                                    <span class="tag">{{ tech }}</span>
                                    {% endfor %}
                                </div>
                                <div class="project-meta">
                                    <span class="price">₹{{ project.price }}</span>
                                    <span class="difficulty {{ project.difficulty|lower }}">{{ project.difficulty }}</span>
                                </div>
                                <a href="/project/{{ project.id }}" class="btn btn-small top-selling-btn">View Details</a>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                <button class="slider-btn left" id="scrollLeftBtn">‹</button>
                <button class="slider-btn right" id="scrollRightBtn">›</button>
            </div>
        </div>
    </section>

    <!-- Make Custom Project Section -->
    <section id="custom-project" class="section custom-project">
        <div class="container">
            <div class="custom-project-content">
                <h2>Make Custom Project for You</h2>
                <p>Need a project tailored to your specific requirements? Our student developers can create custom solutions just for you.</p>
                <div class="custom-project-form">
                    <div class="left-panel">
                        <h3>Custom Project Support</h3>
                        <ul>
                            <li>✔ 24×7 Project Assistance</li>
                            <li>✔ Student & Industry Solutions</li>
                            <li>✔ Mentor-Guided Execution</li>
                        </ul>
                        <div class="contact-info">
                            <p>Phone: +91 87675 55945</p>
                            <p>Email: support@innovateguide.in</p>
                        </div>
                        <blockquote class="ig-quote">
                        “Because every great project starts with your idea.”
                        <span class="ig-quote-sub">Custom-built. Mentor-guided. Result-driven.</span>
                        </blockquote>

                        <br>
                        <div class="how-it-works">
                            <h4>How It Works:</h4>
                            <ol>
                                <li>Submit your requirements</li>
                                <li>We review & respond</li>
                                <li>Get your custom project</li>
                            </ol>
                        </div>
                    </div>
                    <div class="right-panel">
                        <form action="/custom_project_request" method="POST">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="name">Your Name</label>
                                    <input type="text" id="name" name="name" placeholder="Enter your full name" required>
                                </div>
                                <div class="form-group">
                                    <label for="email">Email Address</label>
                                    <input type="email" id="email" name="email" placeholder="Enter your email address" required>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="project-type">Project Type</label>
                                    <select id="project-type" name="project_type" required>
                                        <option value="">Select project type</option>
                                        <option value="web">Web Development</option>
                                        <option value="mobile">Mobile App</option>
                                        <option value="desktop">Desktop Application</option>
                                        <option value="ai">AI/ML Project</option>
                                        <option value="data">Data Science</option>
                                        <option value="iot">IoT Project</option>
                                        <option value="game">Game Development</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="budget">Budget Range</label>
                                    <select id="budget" name="budget" required>
                                        <option value="">Select budget range</option>
                                        <option value="under-50">Under ₹50</option>
                                        <option value="50-100">₹50 - ₹100</option>
                                        <option value="100-200">₹100 - ₹200</option>
                                        <option value="200-500">₹200 - ₹500</option>
                                        <option value="over-500">Over ₹500</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="technologies">Preferred Technologies</label>
                                    <input type="text" id="technologies" name="technologies" placeholder="e.g., Python, React, MongoDB, etc.">
                                    <small>Separate technologies with commas</small>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group full-width">
                                    <label for="deadline">Project Deadline</label>
                                    <input type="date" id="deadline" name="deadline" required>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group full-width">
                                    <label for="description">Project Requirements</label>
                                    <textarea id="description" name="description" rows="6" placeholder="Describe your project requirements in detail. Include features, functionalities, and any specific needs..." required></textarea>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group full-width">
                                    <label for="additional-info">Additional Information</label>
                                    <textarea id="additional-info" name="additional_info" rows="3" placeholder="Any additional requirements, constraints, or special considerations..."></textarea>
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary">Request Custom Project</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>
{% endblock %}

{% block scripts %}

    <script>
        // Carousel functionality
        function moveCarousel(section, direction) {
            const container = document.querySelector(`#${section} .carousel-container`);
            const track = document.querySelector(`#${section} .carousel-track`);
            if (!container || !track) return;

            let cards;
            if (section === 'categories') {
                cards = track.querySelectorAll('.category-card');
            } else {
                cards = track.querySelectorAll('.project-card');
            }

            if (cards.length === 0) return;

            const cardWidth = cards[0].offsetWidth;
            const gap = parseInt(getComputedStyle(track).gap) || 30;
            const scrollDistance = cardWidth + gap;

            container.scrollBy({
                left: direction * scrollDistance,
                behavior: 'smooth'
            });
        }

        // Initialize carousels
        document.addEventListener('DOMContentLoaded', function() {
            // Attach event listeners to buttons for non-categories sections
            const sections = ['trending', 'new-projects', 'mini'];

            sections.forEach(section => {
                const leftBtn = document.querySelector(`#${section} .slider-btn.left`);
                const rightBtn = document.querySelector(`#${section} .slider-btn.right`);

                if (leftBtn) {
                    leftBtn.addEventListener('click', () => moveCarousel(section, -1));
                }
                if (rightBtn) {
                    rightBtn.addEventListener('click', () => moveCarousel(section, 1));
                }
            });

            // Categories infinite loop carousel
            const categoriesContainer = document.querySelector('#categories .carousel-container');
            const categoriesTrack = document.querySelector('#categories .carousel-track');
            if (!categoriesTrack) return;

            let originalCards = Array.from(categoriesTrack.children);
            if (originalCards.length === 0) return;

            const N = originalCards.length;
            const numDuplicates = 10;

            // Clone for prepend
            for (let i = 0; i < numDuplicates; i++) {
                originalCards.forEach(card => {
                    const clone = card.cloneNode(true);
                    categoriesTrack.insertBefore(clone, categoriesTrack.firstChild);
                });
            }

            // Clone for append
            for (let i = 0; i < numDuplicates; i++) {
                originalCards.forEach(card => {
                    const clone = card.cloneNode(true);
                    categoriesTrack.appendChild(clone);
                });
            }

            let allCards = Array.from(categoriesTrack.children);

            // Update dimensions
            function updateDimensions() {
                cardWidth = allCards[0].offsetWidth + parseInt(getComputedStyle(categoriesTrack).gap || 30);
            }
            updateDimensions();

            let position = 0;

            // Set initial position
            categoriesTrack.style.transform = `translateX(-${numDuplicates * N * cardWidth}px)`;
            categoriesTrack.style.transition = 'transform 0.5s ease-in-out';
            categoriesTrack.style.willChange = 'transform';

            // Move categories function
            function moveCategories(direction) {
                position += direction;
                let translateX = -(numDuplicates * N + position) * cardWidth;
                categoriesTrack.style.transform = `translateX(${translateX}px)`;
            }

            // Handle window resize
            window.addEventListener('resize', () => {
                updateDimensions();
                let translateX = -(numDuplicates * N + position) * cardWidth;
                categoriesTrack.style.transform = `translateX(${translateX}px)`;
            });

            // Arrow buttons
            const leftBtn = document.querySelector('#categories .category-slider-btn.left');
            const rightBtn = document.querySelector('#categories .category-slider-btn.right');

            if (leftBtn) {
                leftBtn.addEventListener('click', () => moveCategories(-1));
            }
            if (rightBtn) {
                rightBtn.addEventListener('click', () => moveCategories(1));
            }
        });
    </script>
<script id="add-new-view-class">
(function(){
  try{
    // Add class to existing anchors matching the pattern if template not updated
    document.querySelectorAll('#new-projects .project-card .btn.btn-small').forEach(function(a){
      if (!a.classList.contains('new-view-btn')) a.classList.add('new-view-btn');
    });
    // Force repaint
    void document.body.offsetHeight;
  }catch(e){
    console.warn('new-view-btn injector error', e);
  }
})();
</script>
<script id="add-category-browse-class">
(function(){
  try{
    // Add class to existing category browse buttons for immediate preview
    document.querySelectorAll('#categories .category-card a.btn.btn-small, .categories-section .category-card a.btn.btn-small').forEach(a=>a.classList.add('category-browse-btn'));
    // Force repaint
    void document.body.offsetHeight;
  }catch(e){
    console.warn('category-browse-btn injector error', e);
  }
})();
</script>
<script>
document.addEventListener("DOMContentLoaded", () => {
  const container = document.getElementById("topSellingContainer");
  const leftBtn = document.getElementById("scrollLeftBtn");
  const rightBtn = document.getElementById("scrollRightBtn");

  if (!container || !leftBtn || !rightBtn) return;

  const scrollAmount = container.clientWidth * 0.8;

  leftBtn.addEventListener("click", () => {
    container.scrollBy({ left: -scrollAmount, behavior: "smooth" });
  });

  rightBtn.addEventListener("click", () => {
    container.scrollBy({ left: scrollAmount, behavior: "smooth" });
  });
});
</script>
{% endblock %}